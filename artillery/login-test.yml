config:
  plugin:
    statsd:
      host: "localhost"
      port: 8125
      prefix: "artillery"
  target: https://credit-card.ibmdeveloper.net
  processor: "./custom-artillery-functions.js"
  phases:
    - duration: 1
      arrivalRate: 1
      rampTo: 1
      name: "Login warmup"
    - duration: 300
      arrivalRate: 10
      name: "Login max load"
scenarios:
  - name: "Login testing"
    flow:
      - function: "getUser"
      - log: "The username is: {{ username }}"
      - post:
          url: "/demo/login"
          json:
            username: "{{ username }}"
            password: "{{ username }}"
          capture:
            json: "$"
            as: "error"
      - log: "The response is: {{ error }}"            
  - name: "Get users"
    flow:
      - get:
          url: "/demo/get_all_users"
          capture:
            json: "$"
            as: "response"
      - log: "The response is: {{ response }}"

